{% extends "layouts/base.html" %} {% load static %} {% block content %}
<div class="page-header">
  <h1>Dashboard</h1>
  <p class="text-muted">대시보드 페이지입니다.</p>
</div>

<div class="dashboard-container">
  <!-- 상단: 4개의 수치 카드 -->
  <section class="dashboard-top">
    <div class="stat-card">
      <div class="stat-icon">
        <i class="bi bi-people-fill"></i>
      </div>
      <div class="stat-content">
        <div class="stat-label">현재 총 체류 인원</div>
        <div class="stat-value" id="currentOccupancy">1,234</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">
        <i class="bi bi-bar-chart-fill"></i>
      </div>
      <div class="stat-content">
        <div class="stat-label">현재 총 밀집도</div>
        <div class="stat-value" id="currentDensity">68%</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">
        <i class="bi bi-calendar-day"></i>
      </div>
      <div class="stat-content">
        <div class="stat-label">오늘 누적 방문 인원</div>
        <div class="stat-value" id="todayVisitors">5,678</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">
        <i class="bi bi-calendar-range"></i>
      </div>
      <div class="stat-content">
        <div class="stat-label">기간 내 누적 방문 인원</div>
        <div class="stat-value" id="periodVisitors">45,678</div>
      </div>
    </div>
  </section>

  <!-- 중간: 3개의 그래프 -->
  <section class="dashboard-middle">
    <div class="chart-card">
      <div class="chart-header">
        <h3>현재 총 체류 인원 추이</h3>
      </div>
      <div class="chart-container">
        <canvas id="occupancyChart"></canvas>
      </div>
    </div>

    <div class="chart-card">
      <div class="chart-header">
        <h3>현재 총 밀집도 추이</h3>
      </div>
      <div class="chart-container">
        <canvas id="densityChart"></canvas>
      </div>
    </div>

    <div class="chart-card">
      <div class="chart-header">
        <h3>오늘 누적 방문 인원 추이</h3>
      </div>
      <div class="chart-container">
        <canvas id="visitorsChart"></canvas>
      </div>
    </div>
  </section>

  <!-- 하단: 디바이스 정보 -->
  <section class="dashboard-bottom">
    <div class="bottom-content">
      <div class="device-section">
        <div class="section-header">
          <h2>디바이스 정보</h2>
        </div>
        <div class="table-responsive">
          <table class="device-table">
            <thead>
              <tr>
                <th>디바이스 이름</th>
                <th>위치</th>
                <th>상태</th>
                <th>밀집레벨</th>
                <th>밀집도(m²)</th>
                <th>인원수</th>
                <th>밀집도 추이</th>
                <th>마지막 업데이트</th>
              </tr>
            </thead>
            <tbody>
              <tr data-device-id="1">
                <td>
                  <span class="device-name-text">Device-001</span>
                </td>
                <td>
                  <span class="device-location-text">1층 로비</span>
                </td>
                <td>
                  <span class="device-status-badge online">정상 작동</span>
                </td>
                <td>
                  <span class="density-level-badge high">높음</span>
                </td>
                <td>
                  <span class="density-value">1.56명</span>
                </td>
                <td>
                  <span class="occupancy-count">156명</span>
                </td>
                <td>
                  <div class="sparkline-chart-container">
                    <canvas class="sparkline-chart" data-device-id="1" width="120" height="30"></canvas>
                  </div>
                </td>
                <td>2분 전</td>
              </tr>
              <tr data-device-id="2">
                <td>
                  <span class="device-name-text">Device-002</span>
                </td>
                <td>
                  <span class="device-location-text">2층 복도</span>
                </td>
                <td>
                  <span class="device-status-badge online">정상 작동</span>
                </td>
                <td>
                  <span class="density-level-badge medium">보통</span>
                </td>
                <td>
                  <span class="density-value">0.89명</span>
                </td>
                <td>
                  <span class="occupancy-count">89명</span>
                </td>
                <td>
                  <div class="sparkline-chart-container">
                    <canvas class="sparkline-chart" data-device-id="2" width="120" height="30"></canvas>
                  </div>
                </td>
                <td>1분 전</td>
              </tr>
              <tr data-device-id="3">
                <td>
                  <span class="device-name-text">Device-003</span>
                </td>
                <td>
                  <span class="device-location-text">3층 회의실</span>
                </td>
                <td>
                  <span class="device-status-badge offline">오프라인</span>
                </td>
                <td>
                  <span class="density-level-badge low">낮음</span>
                </td>
                <td>
                  <span class="density-value">--</span>
                </td>
                <td>
                  <span class="occupancy-count">--</span>
                </td>
                <td>
                  <div class="sparkline-chart-container">
                    <canvas class="sparkline-chart" data-device-id="3" width="120" height="30"></canvas>
                  </div>
                </td>
                <td>15분 전</td>
              </tr>
              <tr data-device-id="4">
                <td>
                  <span class="device-name-text">Device-004</span>
                </td>
                <td>
                  <span class="device-location-text">지하 1층</span>
                </td>
                <td>
                  <span class="device-status-badge online">정상 작동</span>
                </td>
                <td>
                  <span class="density-level-badge low">낮음</span>
                </td>
                <td>
                  <span class="density-value">0.34명</span>
                </td>
                <td>
                  <span class="occupancy-count">34명</span>
                </td>
                <td>
                  <div class="sparkline-chart-container">
                    <canvas class="sparkline-chart" data-device-id="4" width="120" height="30"></canvas>
                  </div>
                </td>
                <td>3분 전</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- 알람 로그 섹션 -->
      <div class="alarm-section">
        <div class="section-header">
          <h2>밀집도 알람</h2>
          <button class="btn-clear-alarms" onclick="clearAlarms()" title="알람 지우기">
            <i class="bi bi-trash"></i>
          </button>
        </div>
        <div class="alarm-log-container">
          <div class="alarm-log" id="alarmLog">
            <!-- 알람 로그 항목들이 여기에 동적으로 추가됩니다 -->
          </div>
        </div>
      </div>
    </div>
  </section>
</div>
{% endblock %} {% block scripts %}
<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script src="{% static 'js/dashboard.js' %}"></script>
{% endblock %}
